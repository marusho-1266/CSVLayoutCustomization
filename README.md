# CSVレイアウト変更ツール

CSVファイルのレイアウトを簡単に変更できるWindows用デスクトップアプリケーションです。項目の並べ替え、結合、文字の除去・追加などの操作を直感的に行うことができます。

## 主な機能

- **項目の並べ替え**: CSVファイルの列順序を自由に変更
- **複数項目の結合**: 複数の列を結合して新しい列を作成
- **項目内の特定文字の除去**: 列内の特定の文字を削除
- **項目への特定文字の追加**: 列の値の前後に文字を追加
- **ドラッグ&ドロップ対応**: ファイルを直接ツール上にドロップして処理
- **プロファイル機能**: 設定を保存・再利用可能
- **文字コード対応**: UTF-8とShift-JIS(SJIS)の両方に対応

## インストール方法

### 実行ファイルから（一般ユーザー向け）

1. 提供されたZIPファイルをダウンロードして解凍
2. `CSVLayoutCustomization.exe` をダブルクリックして実行

### ソースコードから（開発者向け）

1. リポジトリをクローンまたはダウンロード
2. 必要なライブラリをインストール
   ```
   pip install pandas tkinterdnd2
   ```
3. Pythonスクリプトを実行
   ```
   python CSVLayoutCustomization.py
   ```

## 使い方

### 基本的な操作手順

1. ツールを起動
2. 左側のパネルでプロファイルを選択または新規作成
3. 必要な設定を入力（並べ替え、結合、文字除去、文字追加）
4. 右側のパネルで入力/出力の文字コードを選択
5. CSVファイルをドラッグ&ドロップするか「ファイルを選択」ボタンでファイルを読み込み
6. プレビューで結果を確認
7. 「変換して保存」ボタンをクリックして変換結果を保存

### 設定方法

#### 項目の並べ替え

カンマ区切りで項目名を入力すると、指定した順に並べ替えられます。
```
氏名,住所,電話番号,メールアドレス
```

#### 複数項目の結合

以下の形式で入力すると、複数の項目を結合できます。
```
氏名:姓,名 
住所:都道府県,市区町村,番地 、
```
※ 最後の区切り文字はスペースで区切って指定します。上記例では「氏名」はスペース区切り、「住所」はカンマ区切りになります。

#### 項目内の特定文字の除去

以下の形式で入力すると、特定の文字を除去できます。
```
電話番号:-,(,)
商品コード:※
```

#### 項目への特定文字の追加

以下の形式で入力すると、特定の位置に文字を追加できます。
```
商品コード:前:A-
価格:後:円
```
※ 位置は「前」または「後」を指定します。

### プロファイル管理

- **新規**: 新しいプロファイルを作成
- **保存**: 現在の設定をプロファイルに保存
- **削除**: 選択中のプロファイルを削除

## 文字コード対応

- **入力文字コード**: CSVファイルを読み込む際のエンコーディング（UTF-8またはShift-JIS）
- **出力文字コード**: 変換後のCSVファイルを保存する際のエンコーディング（UTF-8またはShift-JIS）

選択したエンコーディングでファイルを読み込めない場合、自動的に代替エンコーディングが試行されます。

## 複数端末での利用

このツールは以下の方法で複数の端末で共有できます：

1. 実行ファイル（EXE）を各端末にコピー
2. プロファイル設定ファイル（csv_profiles.json）を各端末の実行ファイルと同じディレクトリにコピー

これにより、設定を共有しながら複数の端末で同じ操作が可能になります。

## 動作環境

- Windows 11
- 推奨メモリ: 4GB以上
- ディスク容量: 50MB以上の空き容量

## トラブルシューティング

### ファイルが読み込めない場合

- ファイルが有効なCSV形式か確認
- 別の文字コードを選択して試す
- ファイルが他のプログラムで開かれていないか確認

### 変換結果が期待通りでない場合

- プレビューで結果を確認
- 項目名が正確に入力されているか確認
- 書式が正しいか確認（カンマ、コロンの使い方など）

### プログラムが起動しない場合

- Windowsのセキュリティソフトがブロックしていないか確認
- .NET Frameworkがインストールされているか確認

## 更新履歴

### v1.0.0 - 2025/04/10
- 初回リリース
- 基本機能の実装（項目の並べ替え、結合、文字除去・追加）
- プロファイル機能の実装
- UTF-8/Shift-JIS対応機能の追加
